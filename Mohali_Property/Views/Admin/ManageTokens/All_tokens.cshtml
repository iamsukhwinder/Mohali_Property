@using Mohali_Property_Model
@model List<KothiModel>
<style>
    #div1 {
        margin-top: 30px;
        margin-left: 30px;
        margin-right: 30px;
    }

    #btneditproduct:hover {
        cursor: pointer;
    }

</style>


<div id="div1">
    <h3>List of All Tokens</h3>
    <table id="tokentable" name="tokentable" class="display responsive">
        <thead>
            <tr>

                <th>Id</th>
                <th>Plot Number</th>
                <th>Plot Size</th>
                @*<th>Associate Name</th>*@
                <th>Customer Name</th>
                <th>Mobile</th>
                <th>Amount</th>
                <th>Booking Amount</th>
                @*<th>Recieved Amount</th>*@
                <th>Actions</th>



            </tr>
        </thead>

    </table>
</div>


@*edit modal*@
<div class="modal fade" id="EditProdModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-bs-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Edit Companies details</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" onclick="EditCloseModal()" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="editModalBody">
               
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="EditCloseModal()" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-warning" onclick="return Update()" id="editProduct">Update changes</button>
            </div>
        </div>
    </div>
</div>



<script>$(function () {
        gettokens();
    });
    function gettokens() {
        $.ajax({
            type: "GET",
            url: "/Token/GetTokenList",
            success: function (data) {
                debugger;
                $('#tokentable').DataTable().clear().destroy();

                $('#tokentable').dataTable({
                    processing: true,

                    "aaData": data,
                    "order": [[0, 'desc']],
                    "columns": [
                        //{
                        //    "data": "id",
                        //    visible: false,
                        //    searchable: false,
                        //},

                        { "data": "token_id"},
                        { "data": "kothi_Number" },
                        { "data": "kothi_size" },
                        { "data": "customer_name" },
                        { "data": "mobile_number" },
                        { "data": "price" },
                        { "data": "booking_amount" },
                        //{ "data": "recieved_ammount" },
                        {
                            "mRender": function (data, type, row) {
                                //return '<img src="/Image/edit.png" height="20" width="20" id="btneditproduct" onclick="showeditcompanymodal(' + row.company_id + ')" title="Edit" data-id=' + row.company_id + 
                                //'>&nbsp;&nbsp;&nbsp;&nbsp;<img src="/Image/delete.png" height="20" width="20" id="btneditproduct" onclick="deletecompanydetail(' + row.company_id + ')" title="Delete" data-id=' 
                                //+ row.company_id + '>'
                                return '<img src="/Image/delete.png" height="20" width="20" id="btneditproduct" onclick="deletetoken(' + row.token_id + ')" title="Delete" data-id='
                                    + row.token_id + '>'

                            }

                        },

                    ]
                })

            },
            failure: function (response) {
                alert(response.responseText);
            },
            error: function (response) {
                alert(response.responseText);
            }
        });
    }

    //to delete the token
    function deletetoken(id){
        var confirm_result  = confirm("Click on ok if you want to delete the token?")
        if(confirm_result){
                    
            $.ajax({
                type: "GET",
                url: "/Token/delete_token/" + id,
                success: function (data) {
                    if(data == 1){
                    alert("Token deleted");
                    gettokens();

                    }
                    else{
                        alert("please try again");
                    }

                },

                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }

            });
        }
    }
</script>
